#!/usr/bin/env sh

set -eu

<% if options[:rails] -%>
# You probably need to run the app in production mode to ensure the correct
# asset URLs are referenced.
export RAILS_ENV=production

# Generate Rails asset pipeline files. In production mode Rails will error for
# any missing asset pipeline files.
bundle exec rails assets:precompile

<% end -%>
# Build with Parklife - and forward arguments sent to this script.
bundle exec parklife build "$@"

# Copy all public resources to ./build.
cp -R public/* build

# List all files in the build (useful for debugging).
find build -type f | sort
